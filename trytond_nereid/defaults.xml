<?xml version="1.0"?>
<!-- This file is part of Tryton & Nereid.  The COPYRIGHT file at the top level of
this repository contains the full copyright notices and license terms. 

WARNING: email template is due for removal in the upcoming release. The email
being sent will henceforth be a part of the template structure and will not
use electronic mail template.
-->
<tryton>
  <data>

    <record id="password_emails" model="electronic_mail.mailbox">
      <field name="name">Password Mails</field>
      <field name="user" ref="res.user_admin"/>
    </record>

    <record id="password_send_email" model="electronic_mail.template">
      <field name="mailbox" ref="password_emails"/>
      <field name="from_">Account Services</field>
      <field name="to">${record.email}</field>
      <field name="subject">Account Activation</field>
      <field name="engine">genshi</field>
      <field name="model" search="[('model', '=', 'nereid.user')]"/>
      <field name="plain">To activate your email account click the link below:
      ${ url_for('nereid.user.activate', user_id=record.id, activation_code=record.activation_code, _external=True) }
      </field>
      <field name="html">To activate your email account click the link below:
      ${ url_for('nereid.user.activate', user_id=record.id, activation_code=record.activation_code, _external=True) }
      </field>
    </record>

    <record id="trigger_password_change" model='ir.trigger'>
      <field name="name">Activation Email</field>
      <field name="model" search="[('model', '=', 'nereid.user')]"/>
      <field name="on_write" eval="True"/>
      <field name="on_create" eval="True"/>
      <field name="condition">self.activation_code</field>
      <field name="action_model" search="[('model', '=', 'electronic_mail.template')]"/>
      <field name="action_function">mail_from_trigger</field>
      <field name="email_template" ref="password_send_email"/>
    </record>

    <record model="nereid.template" id="home_template">
        <field name="name">home.jinja</field>
        <field name="language" search="[('code', '=', 'en_US')]"/>
        <field name="source">
          <![CDATA[
          <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 
          <html lang="en"> 
          <head> 
          <meta http-equiv="content-type" content="text/html; charset=utf-8"> 
          <meta name="robots" content="NONE,NOARCHIVE"> 
          <title>Welcome to Callisto</title> 
          <style type="text/css"> 
          html * {
              padding: 0;
              margin: 0;
          }
           
          body * {
              padding: 10px 20px;
          }
           
          body * * {
              padding: 0;
          }
           
          body {
              font: small sans-serif;
          }
           
          body>div {
              border-bottom: 1px solid #ddd;
          }
           
          h1 {
              font-weight: normal;
          }
           
          h2 {
              margin-bottom: .8em;
          }
           
          h2 span {
              font-size: 80%;
              color: #666;
              font-weight: normal;
          }
           
          h3 {
              margin: 1em 0 .5em 0;
          }
           
          h4 {
              margin: 0 0 .5em 0;
              font-weight: normal;
          }
           
          table {
              border: 1px solid #ccc;
              border-collapse: collapse;
              width: 100%;
              background: white;
          }
           
          tbody td,tbody th {
              vertical-align: top;
              padding: 2px 3px;
          }
           
          thead th {
              padding: 1px 6px 1px 3px;
              background: #fefefe;
              text-align: left;
              font-weight: normal;
              font-size: 11px;
              border: 1px solid #ddd;
          }
           
          tbody th {
              width: 12em;
              text-align: right;
              color: #666;
              padding-right: .5em;
          }
           
          ul {
              margin-left: 2em;
              margin-top: 1em;
          }
           
          #summary {
              background: #e0ebff;
          }
           
          #summary h2 {
              font-weight: normal;
              color: #666;
          }
           
          #explanation {
              background: #eee;
          }
           
          #instructions {
              background: #f6f6f6;
          }
           
          #summary table {
              border: none;
              background: transparent;
          }
          </style> 
          </head> 
           
          <body> 
            <div id="summary"> 
              <h1>It worked!</h1> 
              <h2>Congratulations on your first Nereid-powered page.</h2> 
            </div> 
           
            <div id="instructions"> 
            <p>This is the default home page and needs replacing. To build
              your own home page, inherit the model <code>nereid.website</code> 
              and implement the <code>home</code> method to replace this function.</p> 
          </div> 
           
          <div id="explanation"> 
           
          </div> 
          </body> 
          </html> 
            ]]>
        </field>
    </record>

  </data>
</tryton>
